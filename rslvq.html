

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Robust Soft Learning Vector Quantization &mdash; sklearn-glvq 1.1.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/gallery.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Generalized Learning Vector Quantization" href="glvq.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> sklearn-glvq
          

          
          </a>

          
            
            
              <div class="version">
                1.1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="modules/api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="auto_examples/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="glvq.html">Generalized Learning Vector Quantization</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Robust Soft Learning Vector Quantization</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#matrix-robust-soft-learning-vector-quantization-mrslqv">Matrix Robust Soft Learning Vector Quantization (MRSLQV)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#local-matrix-robust-soft-learning-vector-quantization-lmrslvq">Local Matrix Robust Soft Learning Vector Quantization (LMRSLVQ)</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">sklearn-glvq</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Robust Soft Learning Vector Quantization</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/rslvq.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="robust-soft-learning-vector-quantization">
<span id="rslvq"></span><h1>Robust Soft Learning Vector Quantization<a class="headerlink" href="#robust-soft-learning-vector-quantization" title="Permalink to this headline">¶</a></h1>
<p>A RSLVQ model can be constructed by initializing <a class="reference internal" href="modules/generated/sklearn_lvq.RslvqModel.html#sklearn_lvq.RslvqModel" title="sklearn_lvq.RslvqModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">RslvqModel</span></code></a> with the
desired hyper-parameters, e.g. the number of prototypes, and the initial
positions of the prototypes and then calling the <a class="reference internal" href="modules/generated/sklearn_lvq.RslvqModel.html#sklearn_lvq.RslvqModel.fit" title="sklearn_lvq.RslvqModel.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">RslvqModel.fit</span></code></a> function with the
input data. The resulting model will contain the learned prototype
positions and prototype labels which can be retrieved as properties <code class="xref py py-attr docutils literal notranslate"><span class="pre">w_</span></code>
and <code class="xref py py-attr docutils literal notranslate"><span class="pre">c_w_</span></code>. Classifications of new data can be made via the predict
function, which computes the Euclidean distances of the input data to
all prototypes and returns the label of the respective closest prototypes.</p>
<p>Placing the prototypes is done by optimizing the following cost
function, called the Robust Soft Learning Vector Quantization (RSLVQ)
cost function <a class="footnote-reference" href="#id5" id="id1">[1]</a>:</p>
<p><img class="math" src="_images/math/14728565ecc5630347d9db71d518ec0d48fffa0d.png" alt="\displaystyle E_{\mathrm{RSLVQ}} = \sum_{i=1}^l \mathrm{log}\left(\frac{p(x_i,y_i|W)}{p(x_i|W)}\right)"/></p>
<p>where <img class="math" src="_images/math/e5b9a514fd20394b63559c635d04d171eb13aa8c.png" alt="p(x_i,y_i|W)"/> is the probability density that <img class="math" src="_images/math/7720e563212e11bf72de255ab82c2a3b97c1a7f5.png" alt="x_i"/> is generated by a
mixture component of the correct class <img class="math" src="_images/math/07f6018e00c747406442bb3912e0209766fc9090.png" alt="y_i"/> and <img class="math" src="_images/math/a0783d53659be514054e2a01053156810a7b791b.png" alt="p(x_i|W)"/> is the total
probability density of <img class="math" src="_images/math/7720e563212e11bf72de255ab82c2a3b97c1a7f5.png" alt="x_i"/>.</p>
<p>The optimization is performed via a limited-memory version of the
Broyden-Fletcher-Goldfarb-Shanno algorithm. Regarding runtime, the cost
function can be computed in linear time with respect to the data points:
For each data point, we need to compute the distances to all prototypes,
compute the fraction <img class="math" src="_images/math/0a3acf24011cee0e8e58fa621ddb17c9efaae3dd.png" alt="(d^+_i - d^-_i) / (d^+_i + d^-_i)"/> and then sum up all
these fractions, the same goes for the derivative. Thus, GLVQ scales
linearly with the number of data points.</p>
<div class="section" id="matrix-robust-soft-learning-vector-quantization-mrslqv">
<h2>Matrix Robust Soft Learning Vector Quantization (MRSLQV)<a class="headerlink" href="#matrix-robust-soft-learning-vector-quantization-mrslqv" title="Permalink to this headline">¶</a></h2>
<p>Matrix Robust Soft Learning Vector Quantization (MRSLQV) generalizes over
RSLVQ by learning a full linear
transformation matrix <img class="math" src="_images/math/cd30e0b91d2b53728ae09ccac9d857b79b3adfcb.png" alt="\Omega"/> to support classification.
The matrix product <img class="math" src="_images/math/c262fd250c1539669018ad8aeedc443c75fa13de.png" alt="\Omega^T \cdot \Omega"/> is called the positive
semi-definite <em>relevance matrix</em> <img class="math" src="_images/math/5b99ed91598429157b547a2c3700a6b25c52824a.png" alt="\Lambda"/>. Interpreted this way, MRSLQV is
a <em>metric learning</em> algorithm. It is also possible to initialize the
<a class="reference internal" href="modules/generated/sklearn_lvq.MrslvqModel.html#sklearn_lvq.MrslvqModel" title="sklearn_lvq.MrslvqModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">MrslvqModel</span></code></a> by setting the <code class="xref py py-attr docutils literal notranslate"><span class="pre">dim</span></code> parameter to an integer less than the data
dimensionality, in which case <img class="math" src="_images/math/cd30e0b91d2b53728ae09ccac9d857b79b3adfcb.png" alt="\Omega"/> will have only dim rows, performing
an implicit dimensionality reduction. This variant is called Limited
Rank Matrix LVQ or LiRaM-LVQ <a class="footnote-reference" href="#id3" id="id2">[4]</a>. After initializing the <a class="reference internal" href="modules/generated/sklearn_lvq.MrslvqModel.html#sklearn_lvq.MrslvqModel" title="sklearn_lvq.MrslvqModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">MrslvqModel</span></code></a> and
calling the fit function on your data set, the learned <img class="math" src="_images/math/cd30e0b91d2b53728ae09ccac9d857b79b3adfcb.png" alt="\Omega"/> matrix can
be retrieved via the attribute <cite>omega_</cite>.</p>
<p>The following figure shows how MRSLVQ classifies some example data after
training. The blue dots show represent the prototype. The yellow and
purple dots are the data points. The bigger transparent circle represent
the target value and the smaller circle the predicted target value. The
right side plot shows the data and prototypes multiplied with the
learned <img class="math" src="_images/math/cd30e0b91d2b53728ae09ccac9d857b79b3adfcb.png" alt="\Omega"/> matrix. As can be seen, MRSLVQ effectively projects the
data onto a one-dimensinal line such that both classes are well
distinguished.</p>
<a class="reference external image-reference" href="auto_examples/plot_mrslvq.html"><img alt="_images/sphx_glr_plot_mrslvq_001.png" src="_images/sphx_glr_plot_mrslvq_001.png" /></a>
<div class="topic">
<p class="topic-title first">References:</p>
<table class="docutils footnote" frame="void" id="id3" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[4]</a></td><td><a class="reference external" href="http://www.cs.rug.nl/biehl/Preprints/liram-preliminary.pdf">“Limited Rank Matrix Learning - Discriminative Dimension Reduction and Visualization”</a>
K. Bunte, P. Schneider, B. Hammer, F.-M. Schleif, T. Villmann and M. Biehl - Neural Networks, vol. 26, nb. 4, pp. 159-173, 2012.</td></tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="local-matrix-robust-soft-learning-vector-quantization-lmrslvq">
<h2>Local Matrix Robust Soft Learning Vector Quantization (LMRSLVQ)<a class="headerlink" href="#local-matrix-robust-soft-learning-vector-quantization-lmrslvq" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="modules/generated/sklearn_lvq.LmrslvqModel.html#sklearn_lvq.LmrslvqModel" title="sklearn_lvq.LmrslvqModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">LmrslvqModel</span></code></a> extends RSLVQ by giving each prototype/class relevances for each feature. This way LMRSLVQ is able to project the data for better
classification.</p>
<p>Especially in multi-class data sets, the ideal projection <img class="math" src="_images/math/cd30e0b91d2b53728ae09ccac9d857b79b3adfcb.png" alt="\Omega"/> may be
different for each class, or even each prototype. Localized Matrix Robust Soft
Learning Vector Quantization (LGMLVQ) accounts for this locality
dependence by learning an individual <img class="math" src="_images/math/a0c92b2d911ecaed5d7d15046033c5fe527e0878.png" alt="\Omega_k"/> for each prototype k <a class="footnote-reference" href="#id5" id="id4">[1]</a>.
As with MRSLVQ, the rank of <img class="math" src="_images/math/cd30e0b91d2b53728ae09ccac9d857b79b3adfcb.png" alt="\Omega"/> can be bounded by using the dim
parameter. After initializing the <a class="reference internal" href="modules/generated/sklearn_lvq.LmrslvqModel.html#sklearn_lvq.LmrslvqModel" title="sklearn_lvq.LmrslvqModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">LmrslvqModel</span></code></a> and calling the fit
function on your data set, the learned <img class="math" src="_images/math/a0c92b2d911ecaed5d7d15046033c5fe527e0878.png" alt="\Omega_k"/> matrices can be
retrieved via the attribute <cite>omegas_</cite>.</p>
<p>The following figure shows how LMRSLVQ classifies some example data after
training. The blue dots show represent the prototype. The yellow and
purple dots are the data points. The bigger transparent circle represent
the target value and the smaller circle the predicted target value. The
plot in the middle and on the right show the data and prototypes after
multiplication with the <img class="math" src="_images/math/34b719c3420fe5c82d20557db6d38dc66814f261.png" alt="\Omega_1"/> and <img class="math" src="_images/math/cda0935ebe22bbaf72367c32323890d7de5ebf08.png" alt="\Omega_2"/> matrix respectively. As
can be seen, both prototypes project the data onto one dimension, but
they choose orthogonal projection dimensions, such that the data of the
respective own class is close while the other class gets dispersed,
thereby enhancing classification accuracy. A <a class="reference internal" href="modules/generated/sklearn_lvq.MrslvqModel.html#sklearn_lvq.MrslvqModel" title="sklearn_lvq.MrslvqModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">MrslvqModel</span></code></a> can not solve
this classification problem, because no global <img class="math" src="_images/math/cd30e0b91d2b53728ae09ccac9d857b79b3adfcb.png" alt="\Omega"/> can enhance the
classification significantly.</p>
<a class="reference external image-reference" href="auto_examples/plot_lmrslvq.html"><img alt="_images/sphx_glr_plot_lmrslvq_001.png" src="_images/sphx_glr_plot_lmrslvq_001.png" /></a>
<div class="topic">
<p class="topic-title first">References:</p>
<table class="docutils footnote" frame="void" id="id5" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td><em>(<a class="fn-backref" href="#id1">1</a>, <a class="fn-backref" href="#id4">2</a>)</em> <a class="reference external" href="https://doi.org/10.1162/neco.2009.10-08-892">“Distance Learning in Discriminative Vector Quantization”</a>
Petra Schneider and Michael Biehl and Barbara Hammer - Neural Computation, pp. 2942-2969, 2009.</td></tr>
</tbody>
</table>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="glvq.html" class="btn btn-neutral" title="Generalized Learning Vector Quantization" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Joris Jensen.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.1.0',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          
          SphinxRtdTheme.Navigation.enableSticky();
          
      });
  </script> 

</body>
</html>